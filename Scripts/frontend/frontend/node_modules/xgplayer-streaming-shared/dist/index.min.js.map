{"version":3,"file":"index.min.js","sources":["../src/buffer.js","../src/env.js","../src/error.js","../src/logger.js","../src/utils.js","../src/mse.js","../src/net/types.js","../src/net/error.js","../src/is.js","../src/net/helper.js","../src/event.js","../../../node_modules/eventemitter3/index.js","../src/net/fetch.js","../src/net/xhr.js","../src/net/task.js","../src/streaming-helper.js","../src/net/index.js","../src/net/config.js","../src/services/gap.js","../src/services/sei.js","../src/services/bandwidth.js","../src/services/stats.js","../src/index.umd.js"],"sourcesContent":["export class Buffer {\n  /**\n   * @param {TimeRanges} buf\n   * @returns {number}\n   */\n  static start (buf) {\n    if (!buf || !buf.length) return 0\n\n    // Safari bug: https://bit.ly/2trx6O8\n    if (buf.length === 1 && buf.end(0) - buf.start(0) < 1e-6) return 0\n    // Edge bug: https://bit.ly/2JYLPeB\n    if (buf.length === 1 && buf.start(0) < 0) return 0\n\n    return buf.start(0)\n  }\n\n  /**\n   * @param {TimeRanges} buf\n   * @returns {number}\n   */\n  static end (buf) {\n    if (!buf || !buf.length) return 0\n\n    // Safari bug: https://bit.ly/2trx6O8\n    if (buf.length === 1 && buf.end(0) - buf.start(0) < 1e-6) return 0\n\n    return buf.end(buf.length - 1)\n  }\n\n  /**\n   * @param {{buffered?: TimeRanges}} b\n   * @returns {TimeRanges | void}\n   */\n  static get (b) {\n    if (!b) return\n    try {\n      return b.buffered\n    } catch (error) {\n      // ignore\n    }\n  }\n\n  /**\n   * @param {TimeRanges} buf\n   * @param {number} [maxHole]\n   * @returns {[number,number][]}\n   */\n  static buffers (buf, maxHole) {\n    if (!buf || !buf.length) return []\n\n    const buffers = []\n    for (let i = 0, l = buf.length; i < l; i++) {\n      const bufLen = buffers.length\n      if (!bufLen || !maxHole) {\n        buffers.push([buf.start(i), buf.end(i)])\n      } else {\n        const last = buffers[bufLen - 1]\n        const lastEnd = last[1]\n        const start = buf.start(i)\n        if (start - lastEnd <= maxHole) {\n          const end = buf.end(i)\n          if (end > lastEnd) {\n            last[1] = end\n          }\n        } else {\n          buffers.push([buf.start(i), buf.end(i)])\n        }\n      }\n    }\n    return buffers\n  }\n\n  /**\n   * @param {TimeRanges} buf\n   * @param {number} [maxHole]\n   * @returns {{buffers:[number,number][],length:number}}\n   */\n  static totalLength (buffers) {\n    if (!buffers || !buffers.length) return 0\n    return buffers.reduce((a, c) => (a += (c[1] - c[0])), 0)\n  }\n\n  /**\n   *\n   * @param {TimeRanges} buf\n   * @param {number} [pos=0]\n   * @param {number} [maxHole=0]\n   * @returns {{start:number,end:number,buffers:[number,number][],remaining:number,index?:number,nextStart?:number,nextEnd?:number,prevStart?:number,prevEnd?:number}}\n   */\n  static info (buf, pos = 0, maxHole = 0) {\n    if (!buf || !buf.length) return { start: 0, end: 0, buffers: [] }\n\n    let start = 0\n    let end = 0\n    let index = 0\n    let nextStart = 0\n    let nextEnd = 0\n    let prevStart = 0\n    let prevEnd = 0\n    const buffers = Buffer.buffers(buf, maxHole)\n\n    for (let i = 0, l = buffers.length; i < l; i++) {\n      const item = buffers[i]\n      if (pos + maxHole >= item[0] && pos <= item[1]) {\n        start = item[0]\n        end = item[1]\n        index = i\n      } else if (pos + maxHole < item[0]) {\n        nextStart = item[0]\n        nextEnd = item[1]\n        break\n      } else if (pos + maxHole > item[1]) {\n        prevStart = item[0]\n        prevEnd = item[1]\n      }\n    }\n\n    return {\n      start,\n      end,\n      index,\n      buffers,\n      nextStart,\n      nextEnd,\n      prevStart,\n      prevEnd,\n      currentTime: pos,\n      behind: pos - start,\n      remaining: end ? end - pos : 0,\n      length: Buffer.totalLength && Buffer.totalLength(buffers)\n    }\n  }\n\n  /**\n   *\n   * @param {HTMLMediaElement} media\n   * @param {number} pos\n   * @returns {Boolean}\n   */\n  static isBuffered (media, pos) {\n    if (media) {\n      const buffered = Buffer.get(media)\n\n      if (buffered?.length) {\n        for (let i = 0; i < buffered.length; i++) {\n          if (pos >= buffered.start(i) && pos <= buffered.end(i)) {\n            return true\n          }\n        }\n      }\n    }\n    return false\n  }\n}\n","export const isBrowser = typeof window !== 'undefined'\n","export const ERR = {\n  MANIFEST: 'manifest',\n  NETWORK: 'network',\n  NETWORK_TIMEOUT: 'network_timeout',\n  NETWORK_FORBIDDEN: 'network_forbidden',\n  NETWORK_NOTFOUND: 'network_notfound',\n  NETWROK_RANGE_NOT_SATISFIABLE: 'network_range_not_satisfiable',\n  DEMUX: 'demux',\n  REMUX: 'remux',\n  MEDIA: 'media',\n  DRM: 'drm',\n  OTHER: 'other',\n  RUNTIME: 'runtime',\n\n  SUB_TYPES: {\n    FLV: 'FLV',\n    HLS: 'HLS',\n    MP4: 'MP4',\n    FMP4: 'FMP4',\n    MSE_ADD_SB: 'MSE_ADD_SB',\n    MSE_APPEND_BUFFER: 'MSE_APPEND_BUFFER',\n    MSE_OTHER: 'MSE_OTHER',\n    MSE_FULL: 'MSE_FULL',\n    MSE_CHANGE_TYPE: 'MSE_CHANGE_TYPE',\n    OPTION: 'OPTION',\n    DASH: 'DASH',\n    LICENSE: 'LICENSE',\n    CUSTOM_LICENSE: 'CUSTOM_LICENSE',\n    MSE_HIJACK: 'MSE_HIJACK',\n    EME_HIJACK: 'EME_HIJACK',\n    SIDX: 'SIDX',\n    NO_CANPLAY_ERROR: 'NO_CANPLAY_ERROR',\n    BUFFERBREAK_ERROR: 'BUFFERBREAK_ERROR',\n    WAITING_TIMEOUT_ERROR: 'WAITING_TIMEOUT_ERROR',\n    MEDIA_ERR_ABORTED: 'MEDIA_ERR_ABORTED',\n    MEDIA_ERR_NETWORK: 'MEDIA_ERR_NETWORK',\n    MEDIA_ERR_DECODE: 'MEDIA_ERR_DECODE',\n    MEDIA_ERR_SRC_NOT_SUPPORTED: 'MEDIA_ERR_SRC_NOT_SUPPORTED',\n    MEDIA_ERR_CODEC_NOT_SUPPORTED: 'MEDIA_ERR_CODEC_NOT_SUPPORTED',\n    MEDIA_ERR_URL_EMPTY: 'MEDIA_ERR_URL_EMPTY'\n  }\n}\n\nexport const ERR_CODE = {\n  [ERR.MANIFEST]: {\n    HLS: 1100,\n    DASH: 1200\n  },\n  [ERR.NETWORK]: 2100,\n  [ERR.NETWORK_TIMEOUT]: 2101,\n  [ERR.NETWORK_FORBIDDEN]: 2103,\n  [ERR.NETWORK_NOTFOUND]: 2104,\n  [ERR.NETWROK_RANGE_NOT_SATISFIABLE]: 2116,\n  [ERR.DEMUX]: {\n    FLV: 3100,\n    HLS: 3200,\n    MP4: 3300,\n    FMP4: 3400,\n    SIDX: 3410\n  },\n  [ERR.REMUX]: {\n    FMP4: 4100,\n    MP4: 4200\n  },\n  [ERR.MEDIA]: {\n    MEDIA_ERR_ABORTED: 5101,\n    MEDIA_ERR_NETWORK: 5102,\n    MEDIA_ERR_DECODE: 5103,\n    MEDIA_ERR_SRC_NOT_SUPPORTED: 5104,\n    MEDIA_ERR_CODEC_NOT_SUPPORTED: 5105,\n    MEDIA_ERR_URL_EMPTY: 5106,\n    MSE_ADD_SB: 5200,\n    MSE_APPEND_BUFFER: 5201,\n    MSE_OTHER: 5202,\n    MSE_FULL: 5203,\n    MSE_HIJACK: 5204,\n    MSE_CHANGE_TYPE: 5205,\n    EME_HIJACK: 5301\n  },\n  [ERR.DRM]: {\n    LICENSE: 7100,\n    CUSTOM_LICENSE: 7200\n  },\n  [ERR.OTHER]: 8000,\n  [ERR.RUNTIME]: {\n    NO_CANPLAY_ERROR: 9001,\n    BUFFERBREAK_ERROR: 9002,\n    WAITING_TIMEOUT_ERROR: 9003\n  }\n}\n\nexport class StreamingError extends Error {\n  constructor (type, subType, origin, payload, msg) {\n    super(msg || origin?.message)\n    this.errorType = type === ERR.NETWORK_TIMEOUT ? ERR.NETWORK : type\n    this.originError = origin\n    this.ext = payload\n    this.errorCode = ERR_CODE[type][subType] || ERR_CODE[type]\n    this.errorMessage = this.message\n    if (!this.errorCode) {\n      this.errorType = ERR.OTHER\n      this.errorCode = ERR_CODE[this.errorType]\n    }\n  }\n\n  static create (type, subType, origin, payload, msg) {\n    if (type instanceof StreamingError) {\n      return type\n    } else if (type instanceof Error) {\n      origin = type\n      type = ''\n    }\n\n    if (!type) type = ERR.OTHER\n\n    return new StreamingError(type, subType, origin, payload, msg)\n  }\n\n  static network (error) {\n    return new StreamingError(\n      error?.isTimeout ? ERR.NETWORK_TIMEOUT : ERR.NETWORK,\n      null,\n      error instanceof Error ? error : null,\n      {\n        url: error?.url,\n        response: error?.response,\n        httpCode: error?.response?.status\n      }\n    )\n  }\n}\n","\nexport const LogCacheLevel = {\n  'DEBUG': 1,\n  'LOG': 2,\n  'WARN': 3,\n  'ERROR': 4\n}\nconst LOG_MAX_SIZE = 200 * 1024\nconst SIMPLE_TYPE = ['Boolean', 'Number' ,'String', 'Undefined','Null', 'Date','Object']\nexport class Logger {\n  constructor (name,config) {\n    this.name = name || ''\n    this._prefix = `[${this.name}]`\n    this.logCacheLevel = config?.logCacheLevel || 3\n    this.logMaxSize = config?.logMaxSize || LOG_MAX_SIZE\n    this.logSize = 0\n    this.logTextArray = []\n  }\n\n  debug (...args) {\n    this.logCache(LogCacheLevel.DEBUG,...args)\n    if (Logger.disabled) return\n    console.debug(`[${nowTime()}]`, this._prefix, ...args)\n  }\n\n  log (...args) {\n    this.logCache(LogCacheLevel.LOG,...args)\n    if (Logger.disabled) return\n    console.log(`[${nowTime()}]`, this._prefix, ...args)\n  }\n\n  warn (...args) {\n    this.logCache(LogCacheLevel.WARN,...args)\n    if (Logger.disabled) return\n    console.warn(`[${nowTime()}]`, this._prefix, ...args)\n  }\n\n  error (...args) {\n    this.logCache(LogCacheLevel.ERROR,...args)\n    if (Logger.disabled) return\n    console.error(`[${nowTime()}]`, this._prefix, ...args)\n  }\n\n  logCache (logCacheLevel, ...logText) {\n    if (logCacheLevel < this.logCacheLevel) return\n    let text = ''\n    try {\n      const finLogText = logText.map( item => logable(item))\n      text = `[${nowTime()}]` + this._prefix + (JSON.stringify(finLogText))\n    } catch (e) {\n      return\n    }\n    if (logCacheLevel >= this.logCacheLevel) {\n      this.logSize += text.length\n      this.logTextArray.push(text)\n    }\n    if (this.logSize > this.logMaxSize) {\n      const delLog = this.logTextArray.shift()\n      this.logSize -= delLog.length\n    }\n  }\n\n  getLogCache () {\n    const logText = this.logTextArray.join('\\n')\n    this.reset()\n    return logText\n  }\n\n  reset () {\n    this.logTextArray = []\n    this.logSize = 0\n  }\n\n  table (...args) {\n    if (Logger.disabled) return\n    console.group(this._prefix)\n    console.table(...args)\n    console.groupEnd()\n  }\n\n  static disabled = true\n\n  static enable () {\n    Logger.disabled = false\n  }\n\n  static disable () {\n    Logger.disabled = true\n  }\n\n  setLogLevel (val) {\n    this.logCacheLevel = val\n  }\n}\nfunction nowTime () {\n  return new Date().toLocaleString()\n}\n\nfunction reduceDepth (val) {\n  if (typeof val !== 'object') {\n    return val\n  }\n  const objType = Object.prototype.toString.call(val).slice(8, -1)\n  switch (objType) {\n    case 'Array':\n    case 'Uint8Array':\n    case 'ArrayBuffer':\n\n      return objType + '[' + val.length + ']'\n    case 'Object':\n      return '{}'\n    default:\n      return objType\n  }\n}\n\nfunction logable (obj, maxDepth, depth) {\n  if (!depth) depth = 1\n  if (!maxDepth) maxDepth = 2\n  const result = {}\n\n  if (!obj || typeof obj !== 'object') {\n    return obj\n  }\n\n  const objType = Object.prototype.toString.call(obj).slice(8, -1)\n  if (!SIMPLE_TYPE.includes(objType)) {\n    return objType\n  }\n\n  if (depth > maxDepth) {\n    return undefined\n  }\n\n\n  for (const key in obj) {\n    if (Object.prototype.hasOwnProperty.call(obj, key)) {\n      if (depth === maxDepth) {\n        result[key] = reduceDepth(obj[key])\n      } else if (typeof obj[key] === 'object') {\n        result[key] = logable(obj[key], maxDepth, depth + 1)\n      } else {\n        result[key] = obj[key]\n      }\n    }\n  }\n  return result\n}\n\n","export function createPublicPromise () {\n  let res, rej\n  const promise = new Promise((resolve, reject) => {\n    res = resolve\n    rej = reject\n  })\n  promise.used = false\n  promise.resolve = (...args) => {\n    promise.used = true\n    return res(...args)\n  }\n  promise.reject = (...args) => {\n    promise.used = true\n    return rej(...args)\n  }\n  return promise\n}\n\nexport function nowTime () {\n  try {\n    return parseInt(performance.now(), 10)\n  } catch (e) {\n    return new Date().getTime()\n  }\n}\n\n\nexport const SafeJSON = {\n  stringify (obj) {\n    try {\n      return JSON.stringify(obj)\n    } catch (e) {\n      return ''\n    }\n  },\n  parse (obj) {\n    try {\n      return JSON.parse(obj)\n    } catch (e) {\n      return undefined\n    }\n  }\n}\n","/* eslint-disable no-undef */\nimport { Buffer } from './buffer'\nimport { isBrowser } from './env'\nimport { ERR, StreamingError } from './error'\nimport { Logger } from './logger'\nimport { createPublicPromise, nowTime, SafeJSON } from './utils'\n\nfunction getMediaSource (preferMMS = true) {\n  try {\n    if (!isBrowser) return null\n\n    if (preferMMS && typeof ManagedMediaSource !== 'undefined') return ManagedMediaSource\n\n    return window.MediaSource\n  } catch (e) {}\n}\n\nfunction isMMS (mediaSource) {\n  return /ManagedMediaSource/gi.test(Object.prototype.toString.call(mediaSource))\n}\n\n/**\n * @param {TimeRanges} buffered\n */\nfunction getTimeRanges (buffered) {\n  const ranges = []\n\n  if (buffered instanceof TimeRanges) {\n    for (let i = 0; i < buffered.length; i++) {\n      ranges.push({\n        start: buffered.start(i),\n        end: buffered.end(i)\n      })\n    }\n  }\n  return ranges\n}\n\n/** @enum {string} */\nexport const MSEErrorType = {\n  UPDATE_ERROR: 'updateError'\n}\n\nconst OP_NAME = {\n  APPEND: 'appendBuffer',\n  REMOVE: 'removeBuffer',\n  UPDATE_DURATION:'updateDuration'\n}\n\nexport class MSEError extends Error {\n  /**\n   * @param {MSEErrorType} type\n   * @param {any} [msg]\n   */\n  constructor (type, msg) {\n    super(msg || type)\n    this.type = type\n    this.msg = msg\n  }\n}\n\nexport class MSE {\n  static VIDEO = 'video'\n\n  static AUDIO = 'audio'\n\n  /**\n   * @param {string} [mime='video/mp4; codecs=\"avc1.42E01E,mp4a.40.2\"']\n   * @param { boolean} preferMMS\n   * @returns {boolean}\n   */\n  static isSupported (mime = 'video/mp4; codecs=\"avc1.42E01E,mp4a.40.2\"') {\n    const MediaSource = getMediaSource()\n    if (!MediaSource) return false\n    try {\n      return MediaSource.isTypeSupported(mime)\n    } catch (error) {\n      this._logger.error(mime, error)\n      return false\n    }\n  }\n\n  static isMMSOnly () {\n    return typeof ManagedMediaSource !== 'undefined' && typeof MediaSource === 'undefined'\n  }\n\n  /** @type { HTMLMediaElement | null } */\n  media = null\n\n  /** @type { MediaSource | null } */\n  mediaSource = null\n\n  _openPromise = createPublicPromise()\n\n  _queue = Object.create(null)\n\n  _sourceBuffer = Object.create(null)\n\n  _mseFullFlag = {}\n\n  _st = 0\n\n  _opst = 0\n\n  _logger = null\n\n  _config = null\n  _url = null\n\n\n  static getDefaultConfig () {\n    return {\n      openLog: false,\n      preferMMS: false\n    }\n  }\n\n  /**\n   * @param {HTMLMediaElement} [media]\n   */\n  constructor (media, config) {\n    this._config = Object.assign(MSE.getDefaultConfig(), config)\n    if (media) this.bindMedia(media)\n    this._logger = new Logger('MSE')\n    if (this._config.openLog) {\n      Logger.enable()\n    }\n  }\n\n  get isOpened () {\n    return this.mediaSource?.readyState === 'open'\n  }\n\n  get hasOpTasks () {\n    let flag = false\n    Object.keys(this._queue).forEach(k => {\n      const queue = this._queue[k]\n      if (Array.isArray(queue)) {\n        flag ||= queue.length > 0\n      }\n    })\n    return flag\n  }\n\n  get url () {\n    return this._url\n  }\n\n  get duration () {\n    return this.mediaSource?.duration || -1\n  }\n\n  get isEnded () {\n    return this.mediaSource ? this.mediaSource.readyState === 'ended' : false\n  }\n\n  get streaming () {\n    return isMMS(this.mediaSource) ? this.mediaSource.streaming : true\n  }\n\n  isFull (type) {\n    return type ? this._mseFullFlag[type] : this._mseFullFlag[MSE.VIDEO]\n  }\n\n  /**\n   * @param { number } duration\n   * @return { Promise }\n   */\n  updateDuration (duration) {\n    const isReduceDuration = this.mediaSource && this.mediaSource.duration > duration\n    if (this.mediaSource && this.mediaSource.duration > duration) {\n      let bufferEnd = 0\n      Object.keys(this._sourceBuffer).forEach(k => {\n        try {\n          bufferEnd = Math.max(this.bufferEnd(k) || 0, bufferEnd)\n        } catch (error) {\n          // ignore\n        }\n      })\n      if (duration < bufferEnd) {\n        // 设置值比bufferEnd值小，会导致异常\n        return Promise.resolve()\n      }\n    }\n\n    return this._enqueueBlockingOp(() => {\n      if (this.isEnded) {\n        this._logger.debug('setDuration but ended')\n        return\n      }\n      if (this.mediaSource) {\n        this.mediaSource.duration = duration\n        this._logger.debug('setDuration', duration)\n      }\n    }, OP_NAME.UPDATE_DURATION, {isReduceDuration})\n  }\n\n  /** @return { Promise } */\n  open () {\n    if (this._openPromise.used && !this.isOpened && this.mediaSource) {\n      const ms = this.mediaSource\n      const onOpen = () => {\n        const costTime = nowTime() - this._st\n        this._logger.debug('sourceopen', costTime)\n        ms.removeEventListener('sourceopen', onOpen)\n        this._openPromise.resolve({costtime: costTime})\n      }\n      ms.addEventListener('sourceopen', onOpen)\n      this._openPromise = createPublicPromise()\n    }\n\n    return this._openPromise\n  }\n\n  /**\n   * @private\n   */\n  _onStartStreaming = () => {\n    this._logger.debug('startstreaming')\n  }\n\n  /**\n   * @private\n   */\n  _onEndStreaming = () => {\n    this._logger.debug('endstreaming')\n  }\n\n  /**\n   * @param { HTMLMediaElement } media\n   * @return { Promise }\n   */\n  async bindMedia (media) {\n    if (this.mediaSource || this.media) await this.unbindMedia()\n\n    const MediaSource = getMediaSource(this._config.preferMMS)\n\n    if (!media || !MediaSource) throw new Error('Param media or MediaSource does not exist')\n    this.media = media\n    const ms = this.mediaSource = new MediaSource()\n    const useMMS = isMMS(ms)\n    this._st = nowTime()\n\n    const onOpen = () => {\n      const costTime = nowTime() - this._st\n      this._logger.debug('sourceopen')\n      ms.removeEventListener('sourceopen', onOpen)\n      URL.revokeObjectURL(media.src)\n      this._openPromise.resolve({costtime: costTime})\n    }\n    ms.addEventListener('sourceopen', onOpen)\n    if (useMMS) {\n      ms.addEventListener('startstreaming', this._onStartStreaming)\n      ms.addEventListener('endstreaming', this._onEndStreaming)\n    }\n\n    this._url = URL.createObjectURL(ms)\n    media.src = this._url\n    media.disableRemotePlayback = useMMS\n\n    return this._openPromise\n  }\n\n  /** @return { Promise } */\n  async unbindMedia () {\n    if (!this._openPromise.used) this._openPromise.resolve()\n    const ms = this.mediaSource\n\n    if (ms) {\n      Object.keys(this._queue).forEach((t) => {\n        const queue = this._queue[t]\n        if (queue) {\n          queue.forEach(x => x.promise?.resolve?.())\n        }\n      })\n\n      const hasMetadata = !!this.media && this.media.readyState >= 1\n      const mseOpen = ms.readyState === 'open'\n\n      if (hasMetadata && mseOpen) {\n        try {\n          ms.endOfStream()\n        } catch (error) {\n          // ignore\n        }\n      }\n\n      Object.keys(this._sourceBuffer).forEach(k => {\n        try {\n          ms.removeSourceBuffer(this._sourceBuffer[k])\n        } catch (error) {\n          // ignore\n        }\n      })\n\n      if (isMMS(ms)) {\n        ms.removeEventListener('startstreaming', this._onStartStreaming)\n        ms.removeEventListener('endstreaming', this._onEndStreaming)\n      }\n    }\n\n    if (this.media) {\n      this.media.disableRemotePlayback = false\n      this.media.removeAttribute('src')\n      try {\n        this.media.load()\n      } catch (error) {\n        // ignore\n      }\n      this.media = null\n    }\n\n    this.mediaSource = null\n    this._openPromise = createPublicPromise()\n    this._queue = Object.create(null)\n    this._sourceBuffer = Object.create(null)\n  }\n\n  /**\n   * @param { string } type\n   * @param { string } mimeType\n   */\n  createSource (type, mimeType) {\n    if (this._sourceBuffer[type] || !this.mediaSource) return\n    let sb\n    try {\n      sb = this._sourceBuffer[type] = this.mediaSource.addSourceBuffer(mimeType)\n    } catch (error) {\n      throw new StreamingError(ERR.MEDIA, ERR.SUB_TYPES.MSE_ADD_SB, error)\n    }\n    sb.mimeType = mimeType\n    sb.addEventListener('updateend', this._onSBUpdateEnd.bind(this, type))\n    sb.addEventListener('error', this._onSBUpdateError.bind(this, type))\n  }\n\n  /**\n   * @param { string } type\n   * @param { string } mimeType\n   * @return { Promise }\n   */\n  changeType (type, mimeType) {\n    const sb = this._sourceBuffer[type]\n    if (!this.mediaSource || !sb || sb.mimeType === mimeType) return Promise.resolve()\n\n    if (typeof sb.changeType !== 'function') {\n      return Promise.reject(\n        new StreamingError(\n          ERR.MEDIA,\n          ERR.SUB_TYPES.MSE_CHANGE_TYPE,\n          new Error('changeType is not a function')\n        )\n      )\n    }\n\n    return this._enqueueOp(type, () => {\n      try {\n        sb.changeType(mimeType)\n      } catch (e) {\n        throw new StreamingError(ERR.MEDIA, ERR.SUB_TYPES.MSE_CHANGE_TYPE, e)\n      }\n\n      sb.mimeType = mimeType\n      this._onSBUpdateEnd(type)\n    }, 'changeType', {mimeType})\n  }\n\n  /**\n   * @param { string } type\n   * @param { string } mimeType\n   * @return { Promise }\n   */\n  createOrChangeSource (type, mimeType) {\n    this.createSource(type, mimeType)\n    return this.changeType(type, mimeType)\n  }\n\n  /**\n   * @param { string } type\n   * @param { BufferSource } buffer\n   * @return { Promise }\n   */\n  append (type, buffer, context) {\n    if (!buffer || !buffer.byteLength) {\n      return Promise.resolve()\n    }\n\n    if (!this._sourceBuffer[type]) return Promise.resolve()\n\n    return this._enqueueOp(type, () => {\n      if (!this.mediaSource || this.media.error) return\n      this._logger.debug('MSE APPEND START', context)\n      this._opst = nowTime()\n      this._sourceBuffer[type]?.appendBuffer(buffer)\n    }, OP_NAME.APPEND, context)\n\n  }\n\n  /**\n   * @param { string } type\n   * @param { number } startTime\n   * @param { number } endTime\n   * @return { Promise }\n   */\n  remove (type, startTime, endTime, context) {\n    // if (Object.keys(this._sourceBuffer).length === 1) return Promise.resolve()\n    let isInsertHead = false\n    if (this._mseFullFlag[type]) {\n      isInsertHead = true\n    }\n    return this._enqueueOp(type, () => {\n      if (!this.mediaSource || this.media.error) return\n      const sb = this._sourceBuffer[type]\n      if (startTime >= endTime || !sb) {\n        this._onSBUpdateEnd(type)\n        return\n      }\n      this._opst = nowTime()\n      this._logger.debug('MSE REMOVE START', type, startTime, endTime, context)\n      sb.remove(startTime, endTime)\n    }, OP_NAME.REMOVE, context, isInsertHead)\n  }\n\n  clearBuffer (startTime, endTime) {\n    let p\n    Object.keys(this._sourceBuffer).forEach(k => {\n      p = this.remove(k, startTime, endTime)\n    })\n    return p || Promise.resolve()\n  }\n\n  clearAllBuffer () {\n    let p\n    Object.keys(this._sourceBuffer).forEach(k => {\n      const sb = this._sourceBuffer[k]\n      p = this.remove(k, 0, Buffer.end(Buffer.get(sb)))\n    })\n    return p\n  }\n\n  clearOpQueues (type, allClear) {\n    this._logger.debug('MSE clearOpQueue START')\n    const queue = this._queue[type]\n    if (allClear && queue) {\n      this._queue[type] = []\n      return\n    }\n    if (!queue || !queue[type] || queue.length < 5) return\n    const initQueue = []\n    queue.forEach(op => {\n      if (op.context && op.context.isinit) {\n        initQueue.push(op)\n      }\n    })\n    this._queue[type] = queue.slice(0, 2)\n    initQueue.length > 0 && this._queue[type].push(...initQueue)\n  }\n\n  /**\n   * @param {EndOfStreamError} [reason]\n   * @returns {Promise}\n   */\n  endOfStream (reason) {\n    if (!this.mediaSource || this.mediaSource.readyState !== 'open') return Promise.resolve()\n    return this._enqueueBlockingOp(() => {\n      const ms = this.mediaSource\n      if (!ms || ms.readyState !== 'open') return\n      this._logger.debug('MSE endOfStream START')\n      if (reason) {\n        ms.endOfStream(reason)\n      } else {\n        ms.endOfStream()\n      }\n    }, 'endOfStream')\n  }\n\n  setLiveSeekableRange (start, end) {\n    const ms = this.mediaSource\n    if (start < 0 || end < start || !ms?.setLiveSeekableRange || ms.readyState !== 'open') return\n    ms.setLiveSeekableRange(start, end)\n  }\n\n  /**\n   * @param {string} type\n   * @returns {?SourceBuffer}\n   */\n  getSourceBuffer (type) {\n    return this._sourceBuffer[type]\n  }\n\n  /**\n   * @param { string } type\n   * @return { TimeRanges | void }\n   */\n  buffered (type) {\n    return Buffer.get(this._sourceBuffer[type])\n  }\n\n  /**\n   * @param { string } type\n   * @return { number }\n   */\n  bufferStart (type) {\n    return Buffer.start(this.buffered(type))\n  }\n\n  /**\n   * @param { string } type\n   * @return { number }\n   */\n  bufferEnd (type) {\n    return Buffer.end(this.buffered(type))\n  }\n\n  _enqueueOp (type, exec, opName, context, isInsertHead) {\n    if (!this.mediaSource) return Promise.resolve()\n    const queue = this._queue[type] = this._queue[type] || []\n    const op = {\n      exec,\n      promise: createPublicPromise(),\n      opName,\n      context\n    }\n\n    if (isInsertHead) {\n      queue.splice(0, 0, op)\n      this._mseFullFlag[type] = false\n      this._startQueue(type)\n    } else {\n      queue.push(op)\n    }\n\n    if (this.isOpened || this.isEnded) {\n      if (queue.length === 1) {\n        this._startQueue(type)\n      }\n    } else {\n      this._openPromise.then(() => {\n        if (queue.length === 1) {\n          this._startQueue(type)\n        }\n      })\n    }\n\n\n    return op.promise\n  }\n\n  async _enqueueBlockingOp (exec, opName, context) {\n    if (!this.mediaSource) return Promise.resolve()\n    const types = Object.keys(this._sourceBuffer)\n    if (!types.length) {\n      return exec()\n    }\n\n    const waiters = []\n    types.forEach(t => {\n      const queue = this._queue[t]\n      const prom = createPublicPromise()\n      waiters.push(prom)\n      queue.push({exec: () => {\n        prom.resolve()}, promise: prom, opName, context})\n      if (queue.length === 1) {\n        this._startQueue(t)\n      }\n    })\n\n    return Promise.all(waiters).then(() => {\n      try {\n        return exec()\n      } finally {\n        types.forEach(t => {\n          const queue = this._queue[t]\n          const sb = this._sourceBuffer[t]\n          queue?.shift()\n          if (!sb || !sb.updating) {\n            this._startQueue(t)\n          }\n        })\n      }\n    })\n  }\n\n  _startQueue (type) {\n    const queue = this._queue[type]\n    if (queue) {\n      const op = queue[0]\n      if (op && !this._mseFullFlag[type]) {\n        try {\n          op.exec()\n        } catch (error) {\n          if (error && error.message && error.message.indexOf('SourceBuffer is full') >= 0) {\n            this._mseFullFlag[type] = true\n            if (op.context && typeof op.context === 'object'){\n              op.context.isFull = true\n            }\n            this._logger.error('[MSE error],  context,', op.context, ' ,name,', op.opName, ',err,SourceBuffer is full')\n            op?.promise?.reject(new StreamingError(ERR.MEDIA, ERR.SUB_TYPES.MSE_FULL, error))\n          } else {\n            this._logger.error(error)\n            op?.promise?.reject(\n              error.constructor === StreamingError\n                ? error\n                : new StreamingError(ERR.MEDIA, ERR.SUB_TYPES.MSE_OTHER, error)\n            )\n            queue.shift()\n            this._startQueue(type)\n          }\n        }\n      }\n    }\n  }\n\n  _onSBUpdateEnd = (type) => {\n    const queue = this._queue[type]\n    if (queue) {\n      const op = queue[0]\n      if (!(op?.opName === OP_NAME.UPDATE_DURATION)) {\n        queue.shift()\n      }\n      if (op) {\n        const costtime = nowTime() - this._opst\n        this._logger.debug(`UpdateEnd(${type}/${op.opName})`, SafeJSON.stringify(getTimeRanges(this._sourceBuffer[type]?.buffered)), costtime, op.context)\n        op.promise.resolve({name: op.opName, context: op.context, costtime})\n        const callback = op.context?.callback\n        if (callback && typeof callback === 'function'){\n          callback(op.context)\n        }\n        this._startQueue(type)\n      }\n    }\n  }\n\n  _onSBUpdateError = (type, event) => {\n    const queue = this._queue[type]\n    if (queue) {\n      const op = queue[0]\n      if (op) {\n        this._logger.error('UpdateError', type, op.opName, op.context)\n        op.promise.reject(new StreamingError(ERR.MEDIA, ERR.SUB_TYPES.MSE_APPEND_BUFFER, event))\n        // Do not shift from queue, 'updateend' event will fire next\n      }\n    }\n  }\n\n  setTimeoffset (type, timestampOffset, context) {\n    return this._enqueueOp(type, () => {\n      if (timestampOffset < 0) {\n        timestampOffset += 0.001\n      }\n      this._sourceBuffer[type].timestampOffset = timestampOffset\n      this._onSBUpdateEnd(type)\n    }, 'setTimeoffset', context)\n  }\n\n  /** *重置decode时间戳 */\n  abort (type, context) {\n    if (!this.isOpened) {\n      return Promise.resolve()\n    }\n    return this._enqueueOp(type, () => {\n      this._sourceBuffer[type].abort()\n      this._onSBUpdateEnd(type)\n    }, 'abort', context)\n  }\n}\n","export const LoaderType = {\n  FETCH: 'fetch',\n  XHR: 'xhr'\n}\n\nexport const ResponseType = {\n  ARRAY_BUFFER: 'arraybuffer',\n  TEXT: 'text',\n  JSON: 'json'\n}\n","import { LoaderType } from './types'\n\nexport class NetError extends Error {\n  retryCount = 0\n  isTimeout = false\n  loaderType = LoaderType.FETCH\n  startTime = 0\n  endTime = 0\n  options = {}\n\n  constructor (url, request, response, msg) {\n    super(msg)\n    this.url = url\n    this.request = request\n    this.response = response\n  }\n}\n","const toString = Object.prototype.toString\n\nexport function isObject (a) {\n  return a !== null && typeof a === 'object'\n}\n\nexport function isPlainObject (val) {\n  if (toString.call(val) !== '[object Object]') {\n    return false\n  }\n\n  const prototype = Object.getPrototypeOf(val)\n  return prototype === null || prototype === Object.prototype\n}\n\nexport function isDate (a) {\n  return toString.call(a) === '[object Date]'\n}\n\nexport function isNumber (n) {\n  return typeof n === 'number' && !Number.isNaN(n)\n}\n","import { isDate, isObject } from '../is'\n\nexport function getRangeValue (value) {\n  if (!value || value[0] === null || value[0] === undefined || (value[0] === 0 && (value[1] === null || value[1] === undefined))) {\n    return\n  }\n  let ret = 'bytes=' + value[0] + '-'\n  if (value[1]) ret += value[1]\n  return ret\n}\n\nfunction encode (val) {\n  return encodeURIComponent(val)\n    .replace(/%3A/gi, ':')\n    .replace(/%24/g, '$')\n    .replace(/%2C/gi, ',')\n    .replace(/%20/g, '+')\n    .replace(/%5B/gi, '[')\n    .replace(/%5D/gi, ']')\n}\n\nexport function setUrlParams (url, params) {\n  if (!url) return\n  if (!params) return url\n  let v\n  const str = Object.keys(params).map(k => {\n    v = params[k]\n    if (v === null || v === undefined) return\n    if (Array.isArray(v)) {\n      k = k + '[]'\n    } else {\n      v = [v]\n    }\n\n    return v.map(x => {\n      if (isDate(x)) {\n        x = x.toISOString()\n      } else if (isObject(x)) {\n        x = JSON.stringify(x)\n      }\n      return `${encode(k)}=${encode(x)}`\n    }).join('&')\n  }).filter(Boolean).join('&')\n\n  if (str) {\n    const hashIndex = url.indexOf('#')\n    if (hashIndex !== -1) {\n      url = url.slice(0, hashIndex)\n    }\n\n    url += (url.indexOf('?') === -1 ? '?' : '&') + str\n  }\n\n  return url\n}\n\nexport function createResponse (\n  data,\n  done,\n  response,\n  contentLength,\n  age,\n  startTime,\n  firstByteTime,\n  index,\n  range,\n  vid,\n  priOptions\n) {\n  age = (age !== null && age !== undefined) ? parseFloat(age) : null\n  contentLength = parseInt(contentLength || '0', 10)\n  if (Number.isNaN(contentLength)) contentLength = 0\n  const options = { range, vid, index, contentLength, age, startTime, firstByteTime, endTime: Date.now(), priOptions }\n  return { data, done, options, response }\n}\n\nexport function calculateSpeed (byteLen, milliSecond) {\n  return Math.round(byteLen * 8 * 1000 / milliSecond / 1024) // Kb/s\n}\n","export const EVENT = {\n  ERROR: 'error',\n\n  TTFB: 'core.ttfb',\n  LOAD_START: 'core.loadstart',\n  LOAD_RESPONSE_HEADERS: 'core.loadresponseheaders',\n  LOAD_COMPLETE: 'core.loadcomplete',\n  LOAD_RETRY: 'core.loadretry',\n  SOURCEBUFFER_CREATED: 'core.sourcebuffercreated',\n  MEDIASOURCE_OPENED: 'core.mediasourceopened',\n  ANALYZE_DURATION_EXCEEDED: 'core.analyzedurationexceeded',\n  APPEND_BUFFER: 'core.appendbuffer',\n  REMOVE_BUFFER: 'core.removebuffer',\n  BUFFEREOS: 'core.buffereos',\n  KEYFRAME: 'core.keyframe',\n  CHASEFRAME: 'core.chaseframe',\n  METADATA_PARSED: 'core.metadataparsed',\n  SEI: 'core.sei',\n  SEI_IN_TIME: 'core.seiintime',\n  FLV_SCRIPT_DATA: 'core.flvscriptdata',\n  LOWDECODE: 'core.lowdecode',\n  SWITCH_URL_SUCCESS: 'core.switchurlsuccess',\n  SWITCH_URL_FAILED: 'core.switchurlfailed',\n  SPEED: 'core.speed',\n  HLS_MANIFEST_LOADED: 'core.hlsmanifestloaded',\n  HLS_LEVEL_LOADED: 'core.hlslevelloaded',\n  DEMUXED_TRACK:'core.demuxedtrack',\n\n  STREAM_EXCEPTION: 'core.streamexception',\n  LARGE_AV_FIRST_FRAME_GAP_DETECT: 'LARGE_AV_FIRST_FRAME_GAP_DETECT',\n  LARGE_VIDEO_DTS_GAP_DETECT: 'LARGE_VIDEO_DTS_GAP_DETECT',\n  LARGE_AUDIO_DTS_GAP_DETECT: 'LARGE_AUDIO_DTS_GAP_DETECT',\n  AUDIO_GAP_DETECT: 'AUDIO_GAP_DETECT',\n  AUDIO_OVERLAP_DETECT: 'AUDIO_OVERLAP_DETECT',\n  MAX_DTS_DELTA_WITH_NEXT_SEGMENT_DETECT: 'MAX_DTS_DELTA_WITH_NEXT_SEGMENT_DETECT',\n  REAL_TIME_SPEED: 'real_time_speed'\n}\n","'use strict';\n\nvar has = Object.prototype.hasOwnProperty\n  , prefix = '~';\n\n/**\n * Constructor to create a storage for our `EE` objects.\n * An `Events` instance is a plain object whose properties are event names.\n *\n * @constructor\n * @private\n */\nfunction Events() {}\n\n//\n// We try to not inherit from `Object.prototype`. In some engines creating an\n// instance in this way is faster than calling `Object.create(null)` directly.\n// If `Object.create(null)` is not supported we prefix the event names with a\n// character to make sure that the built-in object properties are not\n// overridden or used as an attack vector.\n//\nif (Object.create) {\n  Events.prototype = Object.create(null);\n\n  //\n  // This hack is needed because the `__proto__` property is still inherited in\n  // some old browsers like Android 4, iPhone 5.1, Opera 11 and Safari 5.\n  //\n  if (!new Events().__proto__) prefix = false;\n}\n\n/**\n * Representation of a single event listener.\n *\n * @param {Function} fn The listener function.\n * @param {*} context The context to invoke the listener with.\n * @param {Boolean} [once=false] Specify if the listener is a one-time listener.\n * @constructor\n * @private\n */\nfunction EE(fn, context, once) {\n  this.fn = fn;\n  this.context = context;\n  this.once = once || false;\n}\n\n/**\n * Add a listener for a given event.\n *\n * @param {EventEmitter} emitter Reference to the `EventEmitter` instance.\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} context The context to invoke the listener with.\n * @param {Boolean} once Specify if the listener is a one-time listener.\n * @returns {EventEmitter}\n * @private\n */\nfunction addListener(emitter, event, fn, context, once) {\n  if (typeof fn !== 'function') {\n    throw new TypeError('The listener must be a function');\n  }\n\n  var listener = new EE(fn, context || emitter, once)\n    , evt = prefix ? prefix + event : event;\n\n  if (!emitter._events[evt]) emitter._events[evt] = listener, emitter._eventsCount++;\n  else if (!emitter._events[evt].fn) emitter._events[evt].push(listener);\n  else emitter._events[evt] = [emitter._events[evt], listener];\n\n  return emitter;\n}\n\n/**\n * Clear event by name.\n *\n * @param {EventEmitter} emitter Reference to the `EventEmitter` instance.\n * @param {(String|Symbol)} evt The Event name.\n * @private\n */\nfunction clearEvent(emitter, evt) {\n  if (--emitter._eventsCount === 0) emitter._events = new Events();\n  else delete emitter._events[evt];\n}\n\n/**\n * Minimal `EventEmitter` interface that is molded against the Node.js\n * `EventEmitter` interface.\n *\n * @constructor\n * @public\n */\nfunction EventEmitter() {\n  this._events = new Events();\n  this._eventsCount = 0;\n}\n\n/**\n * Return an array listing the events for which the emitter has registered\n * listeners.\n *\n * @returns {Array}\n * @public\n */\nEventEmitter.prototype.eventNames = function eventNames() {\n  var names = []\n    , events\n    , name;\n\n  if (this._eventsCount === 0) return names;\n\n  for (name in (events = this._events)) {\n    if (has.call(events, name)) names.push(prefix ? name.slice(1) : name);\n  }\n\n  if (Object.getOwnPropertySymbols) {\n    return names.concat(Object.getOwnPropertySymbols(events));\n  }\n\n  return names;\n};\n\n/**\n * Return the listeners registered for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Array} The registered listeners.\n * @public\n */\nEventEmitter.prototype.listeners = function listeners(event) {\n  var evt = prefix ? prefix + event : event\n    , handlers = this._events[evt];\n\n  if (!handlers) return [];\n  if (handlers.fn) return [handlers.fn];\n\n  for (var i = 0, l = handlers.length, ee = new Array(l); i < l; i++) {\n    ee[i] = handlers[i].fn;\n  }\n\n  return ee;\n};\n\n/**\n * Return the number of listeners listening to a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Number} The number of listeners.\n * @public\n */\nEventEmitter.prototype.listenerCount = function listenerCount(event) {\n  var evt = prefix ? prefix + event : event\n    , listeners = this._events[evt];\n\n  if (!listeners) return 0;\n  if (listeners.fn) return 1;\n  return listeners.length;\n};\n\n/**\n * Calls each of the listeners registered for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Boolean} `true` if the event had listeners, else `false`.\n * @public\n */\nEventEmitter.prototype.emit = function emit(event, a1, a2, a3, a4, a5) {\n  var evt = prefix ? prefix + event : event;\n\n  if (!this._events[evt]) return false;\n\n  var listeners = this._events[evt]\n    , len = arguments.length\n    , args\n    , i;\n\n  if (listeners.fn) {\n    if (listeners.once) this.removeListener(event, listeners.fn, undefined, true);\n\n    switch (len) {\n      case 1: return listeners.fn.call(listeners.context), true;\n      case 2: return listeners.fn.call(listeners.context, a1), true;\n      case 3: return listeners.fn.call(listeners.context, a1, a2), true;\n      case 4: return listeners.fn.call(listeners.context, a1, a2, a3), true;\n      case 5: return listeners.fn.call(listeners.context, a1, a2, a3, a4), true;\n      case 6: return listeners.fn.call(listeners.context, a1, a2, a3, a4, a5), true;\n    }\n\n    for (i = 1, args = new Array(len -1); i < len; i++) {\n      args[i - 1] = arguments[i];\n    }\n\n    listeners.fn.apply(listeners.context, args);\n  } else {\n    var length = listeners.length\n      , j;\n\n    for (i = 0; i < length; i++) {\n      if (listeners[i].once) this.removeListener(event, listeners[i].fn, undefined, true);\n\n      switch (len) {\n        case 1: listeners[i].fn.call(listeners[i].context); break;\n        case 2: listeners[i].fn.call(listeners[i].context, a1); break;\n        case 3: listeners[i].fn.call(listeners[i].context, a1, a2); break;\n        case 4: listeners[i].fn.call(listeners[i].context, a1, a2, a3); break;\n        default:\n          if (!args) for (j = 1, args = new Array(len -1); j < len; j++) {\n            args[j - 1] = arguments[j];\n          }\n\n          listeners[i].fn.apply(listeners[i].context, args);\n      }\n    }\n  }\n\n  return true;\n};\n\n/**\n * Add a listener for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} [context=this] The context to invoke the listener with.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.on = function on(event, fn, context) {\n  return addListener(this, event, fn, context, false);\n};\n\n/**\n * Add a one-time listener for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} [context=this] The context to invoke the listener with.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.once = function once(event, fn, context) {\n  return addListener(this, event, fn, context, true);\n};\n\n/**\n * Remove the listeners of a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn Only remove the listeners that match this function.\n * @param {*} context Only remove the listeners that have this context.\n * @param {Boolean} once Only remove one-time listeners.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.removeListener = function removeListener(event, fn, context, once) {\n  var evt = prefix ? prefix + event : event;\n\n  if (!this._events[evt]) return this;\n  if (!fn) {\n    clearEvent(this, evt);\n    return this;\n  }\n\n  var listeners = this._events[evt];\n\n  if (listeners.fn) {\n    if (\n      listeners.fn === fn &&\n      (!once || listeners.once) &&\n      (!context || listeners.context === context)\n    ) {\n      clearEvent(this, evt);\n    }\n  } else {\n    for (var i = 0, events = [], length = listeners.length; i < length; i++) {\n      if (\n        listeners[i].fn !== fn ||\n        (once && !listeners[i].once) ||\n        (context && listeners[i].context !== context)\n      ) {\n        events.push(listeners[i]);\n      }\n    }\n\n    //\n    // Reset the array, or remove it completely if we have no more listeners.\n    //\n    if (events.length) this._events[evt] = events.length === 1 ? events[0] : events;\n    else clearEvent(this, evt);\n  }\n\n  return this;\n};\n\n/**\n * Remove all listeners, or those of the specified event.\n *\n * @param {(String|Symbol)} [event] The event name.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.removeAllListeners = function removeAllListeners(event) {\n  var evt;\n\n  if (event) {\n    evt = prefix ? prefix + event : event;\n    if (this._events[evt]) clearEvent(this, evt);\n  } else {\n    this._events = new Events();\n    this._eventsCount = 0;\n  }\n\n  return this;\n};\n\n//\n// Alias methods names because people roll like that.\n//\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\nEventEmitter.prototype.addListener = EventEmitter.prototype.on;\n\n//\n// Expose the prefix.\n//\nEventEmitter.prefixed = prefix;\n\n//\n// Allow `EventEmitter` to be imported as module namespace.\n//\nEventEmitter.EventEmitter = EventEmitter;\n\n//\n// Expose the module.\n//\nif ('undefined' !== typeof module) {\n  module.exports = EventEmitter;\n}\n","import { NetError } from './error'\nimport { createResponse, getRangeValue, setUrlParams, calculateSpeed } from './helper'\nimport { ResponseType } from './types'\nimport { EVENT } from '../event'\nimport EventEmitter from 'eventemitter3'\nconst CACHESIZE = 2 * 1024 * 1024\nexport class FetchLoader extends EventEmitter {\n  _abortController = null\n  _timeoutTimer = null\n  _reader = null\n  _response = null\n  _aborted = false\n  _index = -1\n  _range = null\n  _receivedLength = 0\n  _running = false\n  _logger = null\n  _vid = ''\n  _onProcessMinLen = 0\n  _onCancel = null\n  _priOptions = null // 比较私有化的参数传递，回调时候透传\n\n  constructor () {\n    super()\n  }\n\n  load ({\n    url,\n    vid,\n    timeout, // ms\n    responseType,\n    onProgress,\n    index,\n    onTimeout,\n    onCancel,\n    range,\n    transformResponse,\n    request,\n    params,\n    logger,\n\n    method,\n    headers,\n    body,\n    mode,\n    credentials,\n    cache,\n    redirect,\n    referrer,\n    referrerPolicy,\n    onProcessMinLen,\n    priOptions\n  }) {\n    this._logger = logger\n    this._aborted = false\n    this._onProcessMinLen = onProcessMinLen\n    this._onCancel = onCancel\n    this._abortController = typeof AbortController !== 'undefined' && new AbortController()\n    this._running = true\n    this._index = index\n    this._range = range || [0, 0]\n    this._vid = vid || url\n    this._priOptions = priOptions || {}\n    const init = {\n      method,\n      headers,\n      body,\n      mode,\n      credentials,\n      cache,\n      redirect,\n      referrer,\n      referrerPolicy,\n      signal: this._abortController?.signal\n    }\n\n    let isTimeout = false\n    clearTimeout(this._timeoutTimer)\n\n    url = setUrlParams(url, params)\n\n    const rangeValue = getRangeValue(range)\n    if (rangeValue) {\n      if (request) {\n        headers = request.headers\n      } else {\n        headers = init.headers = init.headers || (Headers ? new Headers() : {})\n      }\n      if (Headers && headers instanceof Headers) {\n        headers.append('Range', rangeValue)\n      } else {\n        headers.Range = rangeValue\n      }\n    }\n\n    if (timeout) {\n      this._timeoutTimer = setTimeout(() => {\n        isTimeout = true\n        this.cancel()\n        if (onTimeout) {\n          const error = new NetError(url, init, null, 'timeout')\n          error.isTimeout = true\n          onTimeout(error, {index: this._index, range: this._range, vid: this._vid, priOptions: this._priOptions})\n        }\n      }, timeout)\n    }\n\n    const startTime = Date.now()\n    this._logger.debug('[fetch load start], index,', index, ',range,', range)\n    return new Promise((resolve, reject) => {\n      fetch(request || url, request ? undefined : init).then(async (response) => {\n        clearTimeout(this._timeoutTimer)\n        this._response = response\n        if (this._aborted || !this._running) return\n        if (transformResponse) {\n          response = transformResponse(response, url) || response\n        }\n        if (!response.ok) {\n          throw new NetError(url, init, response, 'bad network response')\n        }\n\n        const firstByteTime = Date.now()\n        let data\n        if (responseType === ResponseType.TEXT) {\n          data = await response.text()\n          this._running = false\n        } else if (responseType === ResponseType.JSON) {\n          data = await response.json()\n          this._running = false\n        } else {\n          if (onProgress) {\n            this.resolve = resolve\n            this.reject = reject\n            this._loadChunk(response, onProgress, startTime, firstByteTime)\n            return\n          } else {\n            data = await response.arrayBuffer()\n            data = new Uint8Array(data)\n            this._running = false\n            const costTime = Date.now() - startTime\n            const speed = calculateSpeed(data.byteLength, costTime)\n            this.emit(EVENT.REAL_TIME_SPEED, {speed,len: data.byteLength, time: costTime, vid: this._vid, index: this._index, range: this._range, priOptions: this._priOptions})\n          }\n        }\n        this._logger.debug('[fetch load end], index,', index, ',range,', range)\n        resolve(createResponse(\n          data,\n          true,\n          response,\n          response.headers.get('Content-Length'),\n          response.headers.get('age'),\n          startTime,\n          firstByteTime,\n          index,\n          range,\n          this._vid,\n          this._priOptions\n        ))\n      }).catch((error) => {\n        clearTimeout(this._timeoutTimer)\n        this._running = false\n        if (this._aborted && !isTimeout) return\n        error = error instanceof NetError ? error : new NetError(url, init, null, error?.message)\n        error.startTime = startTime\n        error.endTime = Date.now()\n        error.isTimeout = isTimeout\n        error.options = {index: this._index, range: this._range, vid: this._vid, priOptions: this._priOptions}\n        reject(error)\n      })\n    })\n  }\n\n  async cancel () {\n    if (this._aborted) return\n    this._aborted = true\n    this._running = false\n    if (this._response) {\n      try {\n        // await this._response.body.cancel()\n        if (this._reader) {\n          await this._reader.cancel()\n        }\n      } catch (error) {\n        // ignore\n      }\n      this._response = this._reader = null\n    }\n\n    if (this._abortController) {\n      try {\n        this._abortController.abort()\n      } catch (error) {\n        // ignore\n      }\n      this._abortController = null\n    }\n    if (this._onCancel) {\n      this._onCancel({index: this._index, range: this._range, vid: this._vid, priOptions: this._priOptions})\n    }\n  }\n\n  _loadChunk (response, onProgress, st, firstByteTime) {\n    if (!response.body || !response.body.getReader) {\n      this._running = false\n      const err = new NetError(response.url, '', response, 'onProgress of bad response.body.getReader')\n      err.options = {index: this._index, range: this._range, vid: this._vid, priOptions: this._priOptions}\n      this.reject(err)\n      return\n    }\n    if (this._onProcessMinLen > 0) {\n      this._cache = new Uint8Array(CACHESIZE)\n      this._writeIdx = 0\n    }\n    const reader = this._reader = response.body.getReader()\n    let data\n\n    let startTime\n    let endTime\n    const pump = async () => {\n      startTime = Date.now()\n      try {\n        data = await reader.read()\n        endTime = Date.now()\n      } catch (e) {\n        // request aborted\n        endTime = Date.now()\n        if (!this._aborted) {\n          this._running = false\n          e.options = {index: this._index, range: this._range, vid: this._vid, priOptions: this._priOptions}\n          this.reject(e)\n        }\n        return\n      }\n      const startRange = this._range?.length > 0 ? this._range[0] : 0\n      const startByte = startRange + this._receivedLength\n      if (this._aborted) {\n        this._running = false\n        onProgress(undefined, false, { range: [startByte, startByte], vid: this._vid, index: this._index, startTime, endTime, st, firstByteTime, priOptions:this._priOptions }, response)\n        return\n      }\n      const curLen = data.value ? data.value.byteLength : 0\n      this._receivedLength += curLen\n      this._logger.debug('【fetchLoader,onProgress call】,task,', this._range, ', start,', startByte, ', end,', startRange + this._receivedLength, ', done,', data.done)\n      let retData\n      if (this._onProcessMinLen > 0) {\n        if (this._writeIdx + curLen >= this._onProcessMinLen || data.done) {\n          retData = new Uint8Array(this._writeIdx + curLen)\n          retData.set(this._cache.slice(0, this._writeIdx), 0)\n          curLen > 0 && retData.set(data.value, this._writeIdx)\n          this._writeIdx = 0\n          this._logger.debug('【fetchLoader,onProgress enough】,done,', data.done, ',len,', retData.byteLength, ', writeIdx,', this._writeIdx)\n        } else {\n          if (curLen > 0 && this._writeIdx + curLen < CACHESIZE) {\n            this._cache.set(data.value, this._writeIdx)\n            this._writeIdx += curLen\n            this._logger.debug('【fetchLoader,onProgress cache】,len,', curLen, ', writeIdx,', this._writeIdx)\n          } else if (curLen > 0) {\n            const temp = new Uint8Array(this._writeIdx + curLen + 2048)\n            this._logger.debug('【fetchLoader,onProgress extra start】,size,', this._writeIdx + curLen + 2048, ', datalen,', curLen, ', writeIdx,', this._writeIdx)\n            temp.set(this._cache.slice(0, this._writeIdx), 0)\n            curLen > 0 && temp.set(data.value, this._writeIdx)\n            this._writeIdx += curLen\n            delete this._cache\n            this._cache = temp\n            this._logger.debug('【fetchLoader,onProgress extra end】,len,', curLen, ', writeIdx,', this._writeIdx)\n          }\n        }\n      } else {\n        retData = data.value\n      }\n      if (retData && retData.byteLength > 0 || data.done) {\n        onProgress(retData, data.done, {\n          range: [this._range[0] + this._receivedLength - (retData ? retData.byteLength : 0), this._range[0] + this._receivedLength],\n          vid: this._vid,\n          index: this._index,\n          startTime,\n          endTime,\n          st,\n          firstByteTime,\n          priOptions:this._priOptions\n        }, response)\n      }\n      if (!data.done) {\n        pump()\n      } else {\n        const costTime = Date.now() - st\n        const speed = calculateSpeed(this._receivedLength, costTime)\n        this.emit(EVENT.REAL_TIME_SPEED, {speed,len: this._receivedLength, time: costTime, vid: this._vid, index: this._index, range: this._range, priOptions: this._priOptions})\n        this._running = false\n        this._logger.debug('[fetchLoader onProgress end],task,', this._range, ',done,', data.done)\n        this.resolve(createResponse(\n          data,\n          true,\n          response,\n          response.headers.get('Content-Length'),\n          response.headers.get('age'),\n          st,\n          firstByteTime,\n          this._index,\n          this._range,\n          this._vid,\n          this._priOptions\n        ))\n      }\n    }\n    pump()\n  }\n\n  get receiveLen () {\n    return this._receivedLength\n  }\n\n  get running () {\n    return this._running\n  }\n\n  set running (status) {\n    this._running = status\n  }\n\n  static isSupported () {\n    return !!(typeof fetch !== 'undefined')\n  }\n}\n","import { NetError } from './error'\nimport { createResponse, getRangeValue, setUrlParams, calculateSpeed } from './helper'\nimport { ResponseType } from './types'\nimport { EVENT } from '../event'\nimport EventEmitter from 'eventemitter3'\nexport class XhrLoader extends EventEmitter {\n\n  _xhr = null\n  _aborted = false\n  _timeoutTimer = null\n  _range = null\n  _receivedLength = 0\n  _url = null\n  _onProgress = null\n  _index = -1\n  _headers = null\n  // _chunkSizeKBList = [\n  //   128, 256, 384, 512, 768, 1024, 1536, 2048, 3072, 4096, 5120, 6144, 7168, 8192\n  // ]\n\n  _currentChunkSizeKB = 384\n  _timeout = null\n  _xhr = null\n  _withCredentials = null\n  _startTime = -1\n  // _speedSampler = new SpeedSampler()\n  _loadCompleteResolve = null\n  _loadCompleteReject = null\n  _runing = false\n  _logger = false\n  _vid = ''\n  _responseType\n  _credentials\n  _method\n  _transformResponse\n  _firstRtt\n  _onCancel = null\n  _priOptions = null // 比较私有化的参数传递，回调时候透传\n\n\n  constructor () {\n    super()\n  }\n\n  load (req) {\n    clearTimeout(this._timeoutTimer)\n    this._logger = req.logger\n    this._range = req.range\n    this._onProgress = req.onProgress\n    this._index = req.index\n    this._headers = req.headers\n    this._withCredentials = req.credentials === 'include' || req.credentials === 'same-origin'\n    this._body = req.body || null\n    req.method && (this._method = req.method)\n    this._timeout = req.timeout || null\n    this._runing = true\n    this._vid = req.vid || req.url\n    this._responseType = req.responseType\n    this._firstRtt = -1\n    this._onTimeout = req.onTimeout\n    this._onCancel = req.onCancel\n    this._request = req.request\n    this._priOptions = req.priOptions || {}\n    this._logger.debug('【xhrLoader task】, range', this._range)\n\n    this._url = setUrlParams(req.url, req.params)\n\n    const startTime = Date.now()\n    return new Promise((resolve, reject) => {\n      this._loadCompleteResolve = resolve\n      this._loadCompleteReject = reject\n      this._startLoad()\n    }).catch((error) => {\n      clearTimeout(this._timeoutTimer)\n      this._runing = false\n      if (this._aborted) return\n      error = error instanceof NetError ? error : new NetError(this._url, this._request)\n      error.startTime = startTime\n      error.endTime = Date.now()\n      error.options = {index: this._index, vid: this._vid, priOptions: this._priOptions}\n      throw error\n    })\n  }\n\n  _startLoad () {\n    let range = null\n    if (this._responseType === ResponseType.ARRAY_BUFFER && this._range && this._range.length > 1) {\n      if (this._onProgress) {\n        this._firstRtt = -1\n        const chunkSize = this._currentChunkSizeKB * 1024\n        const from = this._range[0] + this._receivedLength\n        let to = this._range[1]\n        if (chunkSize < this._range[1] - from) {\n          to = from + chunkSize\n        }\n        range = [from, to]\n        this._logger.debug('[xhr_loader->],tast :', this._range, ', SubRange, ', range)\n      } else {\n        range = this._range\n        this._logger.debug('[xhr_loader->],tast :', this._range, ', allRange, ', range)\n      }\n    }\n    this._internalOpen(range)\n  }\n\n  _internalOpen (range) {\n    try {\n      this._startTime = Date.now()\n      const xhr = this._xhr = new XMLHttpRequest()\n      xhr.open(this._method || 'GET', this._url, true)\n      xhr.responseType = this._responseType\n      this._timeout && (xhr.timeout = this._timeout)\n      xhr.withCredentials = this._withCredentials\n      xhr.onload = this._onLoad.bind(this)\n      xhr.onreadystatechange = this._onReadyStatechange.bind(this)\n      xhr.onerror = (errorEvent) => {\n        this._running = false\n        const error = new NetError(this._url, this._request, errorEvent?.currentTarget?.response, ('xhr.onerror.status:' + errorEvent?.currentTarget?.status + ',statusText,' + errorEvent?.currentTarget?.statusText))\n        error.options = {index: this._index, range: this._range, vid: this._vid, priOptions: this._priOptions}\n        this._loadCompleteReject(error)\n      }\n      xhr.ontimeout = (event) => {\n        this.cancel()\n        const error = new NetError(this._url, this._request, {status:408}, 'timeout')\n        if (this._onTimeout) {\n          error.isTimeout = true\n          this._onTimeout(error,{index: this._index, range: this._range, vid: this._vid, priOptions: this._priOptions})\n        }\n        error.options = {index: this._index, range: this._range, vid: this._vid, priOptions: this._priOptions}\n        this._loadCompleteReject(error)\n      }\n      const headers = this._headers || {}\n      const rangeValue = getRangeValue(range)\n      if (rangeValue) {\n        headers.Range = rangeValue\n      }\n      if (headers) {\n        Object.keys(headers).forEach(k => {\n          xhr.setRequestHeader(k, headers[k])\n        })\n      }\n      this._logger.debug('[xhr.send->] tast,', this._range, ',load sub range, ', range)\n      xhr.send(this._body)\n    } catch (e) {\n      e.options = {index: this._index, range, vid: this._vid, priOptions: this._priOptions}\n      this._loadCompleteReject(e)\n    }\n  }\n\n  _onReadyStatechange (e) {\n    const xhr = e.target\n    if (xhr.readyState === 2) {\n      this._firstRtt < 0 && (this._firstRtt = Date.now())\n    }\n  }\n\n  _onLoad (e) {\n    const status = e.target.status\n    if (status < 200 || status > 299) {\n      const error = new NetError(this._url, null, { ...e.target.response, status }, 'bad response,status:' + status)\n      error.options = {index: this._index, range: this._range, vid: this._vid, priOptions: this._priOptions}\n      return this._loadCompleteReject(error)\n    }\n    let data = null\n    let done = false\n    let byteStart\n    const startRange = (this._range?.length > 0 ? this._range [0] : 0 )\n    if (this._responseType === ResponseType.ARRAY_BUFFER) {\n      const chunk = new Uint8Array(e.target.response)\n      byteStart = startRange + this._receivedLength\n      if (chunk && chunk.byteLength > 0) {\n        this._receivedLength += chunk.byteLength\n        const costTime = Date.now() - this._startTime\n        const speed = calculateSpeed(this._receivedLength, costTime)\n        this.emit(EVENT.REAL_TIME_SPEED, {speed, len: this._receivedLength, time: costTime, vid: this._vid, index: this._index, range: [byteStart, startRange + this._receivedLength], priOptions: this._priOptions})\n      }\n      data = chunk\n      if (this._range?.length > 1 && this._range[1] && this._receivedLength < this._range[1] - this._range[0]) {\n        done = false\n      } else {\n        done = true\n      }\n      this._logger.debug('[xhr load done->], tast :', this._range, ', start', byteStart, 'end ', startRange + this._receivedLength, ',dataLen,', (chunk ? chunk.byteLength : 0), ',receivedLength', this._receivedLength, ',index,', this._index, ', done,', done)\n    } else {\n      done = true\n      data = e.target.response\n    }\n    let response = {\n      ok: status >= 200 && status < 300,\n      status,\n      statusText: this._xhr.statusText,\n      url: this._xhr.responseURL,\n      headers: this._getHeaders(this._xhr),\n      body: this._xhr.response\n    }\n    if (this._transformResponse) {\n      response = this._transformResponse(response, this._url) || response\n    }\n    if (this._onProgress) {\n      this._onProgress(data, done, { index: this._index, vid: this._vid, range: [byteStart, startRange + this._receivedLength], startTime: this._startTime, endTime: Date.now(), priOptions: this._priOptions }, response)\n    }\n\n    if (!done) {\n      this._startLoad()\n    } else {\n      this._runing = false\n      this._loadCompleteResolve && this._loadCompleteResolve(createResponse(\n        this._onProgress ? null : data,\n        done,\n        response,\n        response.headers['content-length'],\n        response.headers.age,\n        this._startTime,\n        this._firstRtt,\n        this._index,\n        this._range,\n        this._vid,\n        this._priOptions\n      ))\n    }\n  }\n\n  cancel () {\n    if (this._aborted) return\n    this._aborted = true\n    this._runing = false\n    super.removeAllListeners()\n    if (this._onCancel) {\n      this._onCancel({index: this._index, range: this._range, vid: this._vid, priOptions: this._priOptions})\n    }\n    if (this._xhr) {\n      return this._xhr.abort()\n    }\n  }\n\n  static isSupported () {\n    return typeof XMLHttpRequest !== 'undefined'\n  }\n\n  get receiveLen () {\n    return this._receivedLength\n  }\n\n  get running () {\n    return this._running\n  }\n\n  set running (status) {\n    this._running = status\n  }\n\n  _getHeaders (xhr) {\n    const headerLines = xhr.getAllResponseHeaders().trim().split('\\r\\n')\n    const headers = {}\n    for (const header of headerLines) {\n      const parts = header.split(': ')\n      headers[parts[0].toLowerCase()] = parts.slice(1).join(': ')\n    }\n    return headers\n  }\n}\n","import { FetchLoader } from './fetch'\nimport { XhrLoader } from './xhr'\nimport { LoaderType } from './types'\nimport { createPublicPromise } from '../utils'\nimport { Logger } from '../logger'\n\nexport class Task {\n  constructor (type, config) {\n    this.promise = createPublicPromise()\n    this.alive = !!config.onProgress\n    !config.logger && (config.logger = new Logger('Loader'))\n    this._loaderType = type\n    this._loader = type === LoaderType.FETCH && typeof fetch !== 'undefined' ? new FetchLoader() : new XhrLoader()\n    this._config = config\n    this._retryCount = 0\n    this._retryTimer = null\n    this._canceled = false\n    this._retryCheckFunc = config.retryCheckFunc\n    this._logger = config.logger\n  }\n\n  exec () {\n    const {\n      retry,\n      retryDelay,\n      onRetryError,\n      transformError,\n      ...rest\n    } = this._config\n\n    const request = async () => {\n      try {\n        const response = await this._loader.load(rest)\n        this.promise.resolve(response)\n      } catch (e) {\n        this._loader.running = false\n        this._logger.debug('[task request catch err]', e)\n        if (this._canceled) return\n\n        e.loaderType = this._loaderType\n        e.retryCount = this._retryCount\n\n        let error = e\n        if (transformError) {\n          error = transformError(error) || error\n        }\n\n        if (onRetryError && this._retryCount > 0) onRetryError(error, this._retryCount, {index: rest.index, vid: rest.vid, range: rest.range, priOptions: rest.priOptions})\n\n        this._retryCount++\n        let isRetry = true\n        if (this._retryCheckFunc) {\n          isRetry = this._retryCheckFunc(e)\n        }\n        if (isRetry && this._retryCount <= retry) {\n          clearTimeout(this._retryTimer)\n          this._logger.debug('[task request setTimeout],retry', this._retryCount, ',retry range,', rest.range)\n          this._retryTimer = setTimeout(request, retryDelay)\n          return\n        }\n        this.promise.reject(error)\n      }\n    }\n\n    request()\n    return this.promise\n  }\n\n  async cancel () {\n    clearTimeout(this._retryTimer)\n    this._canceled = true\n    this._loader.running = false\n    return this._loader.cancel()\n  }\n\n  get running () {\n    return this._loader && this._loader.running\n  }\n\n  get loader () {\n    return this._loader\n  }\n}\n","export function isMediaPlaying (media) {\n  return media && !media.paused && !media.ended && media.playbackRate !== 0 && media.readyState !== 0\n}\n\nexport function getVideoPlaybackQuality (video) {\n  if (!video) return {}\n  if (typeof video.getVideoPlaybackQuality === 'function') {\n    const info = video.getVideoPlaybackQuality()\n    return {\n      droppedVideoFrames: info.droppedVideoFrames || info.corruptedVideoFrames,\n      totalVideoFrames: info.totalVideoFrames,\n      creationTime: info.creationTime\n    }\n  }\n\n  return {\n    droppedVideoFrames: video.webkitDroppedFrameCount,\n    totalVideoFrames: video.webkitDecodedFrameCount,\n    creationTime: performance.now()\n  }\n}\n\n/**\n * @param {Array.<Uint8Array>} arr\n * @returns\n */\nexport function concatUint8Array (...arr) {\n  arr = arr.filter(Boolean)\n  if (arr.length < 2) return arr[0]\n  const data = new Uint8Array(arr.reduce((p, c) => p + c.byteLength, 0))\n  let prevLen = 0\n  arr.forEach((d) => {\n    data.set(d, prevLen)\n    prevLen += d.byteLength\n  })\n  return data\n}\n\nexport function sleep (t = 0) {\n  return new Promise((resolve) => setTimeout(resolve, t))\n}\n","import { FetchLoader } from './fetch'\nimport { LoaderType, ResponseType } from './types'\nimport { getConfig } from './config'\nimport { Task } from './task'\nimport { isPlainObject } from '../is'\nimport { sleep } from '../streaming-helper'\nimport { EVENT } from '../event'\nimport EventEmitter from 'eventemitter3'\n\nexport {\n  LoaderType,\n  ResponseType\n}\n\nexport class NetLoader extends EventEmitter {\n  type = LoaderType.FETCH\n\n  _queue = []\n\n  _alive = []\n\n  _currentTask = null\n\n  _finnalUrl = ''\n\n  _config\n\n  constructor (cfg) {\n    super(cfg)\n    this._config = getConfig(cfg)\n    if (\n      this._config.loaderType === LoaderType.XHR ||\n      !FetchLoader.isSupported()\n    ) {\n      this.type = LoaderType.XHR\n    }\n    this.log = cfg.logger\n  }\n\n  isFetch () {\n    return this.type === LoaderType.FETCH\n  }\n\n  static isFetchSupport () {\n    return FetchLoader.isSupported()\n  }\n\n  load (url, config = {}) {\n    if (typeof url === 'string' || !url) {\n      config.url = url || config.url || this._config.url\n    } else {\n      config = url\n    }\n\n    config = Object.assign({}, this._config, config)\n\n    if (config.params) config.params = Object.assign({}, config.params)\n    if (config.headers && isPlainObject(config.headers)) config.headers = Object.assign({}, config.headers)\n    if (config.body && isPlainObject(config.body)) config.body = Object.assign({}, config.body)\n\n    if (config.transformRequest) {\n      config = config.transformRequest(config) || config\n    }\n    config.logger = this.log\n\n    const task = new Task(this.type, config)\n    task.loader.on(EVENT.REAL_TIME_SPEED, (data) => {\n      this.emit(EVENT.REAL_TIME_SPEED, data)\n    })\n    this._queue.push(task)\n    if (this._queue.length === 1 && (!this._currentTask || !this._currentTask.running)) {\n      this._processTask()\n    }\n\n    return task.promise\n  }\n\n  async cancel () {\n    const cancels = this._queue.map(t => t.cancel()).concat(this._alive.map(t => t.cancel()))\n    if (this._currentTask) {\n      cancels.push(this._currentTask.cancel())\n    }\n    this._queue = []\n    this._alive = []\n    await Promise.all(cancels)\n    await sleep()\n  }\n\n  _processTask () {\n    this._currentTask = this._queue.shift()\n    if (!this._currentTask) return\n\n    if (this._currentTask.alive) {\n      this._alive.push(this._currentTask)\n    }\n    const req = this._currentTask.exec().catch(e => {})\n\n    if (!(req && typeof req.finally === 'function')) return\n\n    req.finally(() => {\n      if (this._currentTask?.alive && this._alive?.length > 0) {\n        this._alive = this._alive.filter(task => task && task !== this._currentTask)\n      }\n      this._processTask()\n    })\n\n  }\n}\n","import { LoaderType, ResponseType } from './types'\n\nexport function getConfig (cfg) {\n  return {\n    loaderType: LoaderType.FETCH,\n    retry: 0,\n    retryDelay: 0, // ms\n    timeout: 0,\n    request: null, // Request\n    onTimeout: undefined,\n    onProgress: undefined,\n    onRetryError: undefined,\n    transformRequest: undefined,\n    transformResponse: undefined,\n    transformError: undefined,\n    responseType: ResponseType.TEXT,\n    range: undefined,\n    url: '',\n    params: undefined,\n    method: 'GET',\n    headers: {},\n    body: undefined,\n    mode: undefined,\n    credentials: undefined,\n    cache: undefined,\n    redirect: undefined,\n    referrer: undefined,\n    referrerPolicy: undefined,\n    integrity: undefined,\n    onProcessMinLen: 0,\n    ...cfg\n  }\n}\n","import { Buffer } from '../buffer'\n\nexport class GapService {\n  _prevCurrentTime = 0\n\n  do (media, maxJumpDistance = 3, isLive, seekThreshold = 1) {\n    if (!media) return\n\n    const currentTime = media.currentTime\n    let jumpTo = 0\n\n    if (this._prevCurrentTime === currentTime) {\n      const info = Buffer.info(Buffer.get(media), currentTime)\n      if (!info.buffers.length) return\n      if (\n        (isLive && info.nextStart) ||\n        (info.nextStart && info.nextStart - currentTime < maxJumpDistance)\n      ) {\n        jumpTo = info.nextStart + 0.1\n      } else if (info.end && info.end - currentTime > seekThreshold && !media.seeking) {\n        jumpTo = currentTime + 0.1\n      }\n    }\n\n    this._prevCurrentTime = currentTime\n\n    if (jumpTo && currentTime !== jumpTo) {\n      media.currentTime = jumpTo\n    }\n  }\n}\n","import { EVENT } from '../event'\n\nexport class SeiService {\n  _seiSet = new Set()\n\n  constructor (emitter) {\n    this.emitter = emitter\n\n    emitter.on(EVENT.SEI, sei => {\n      if (sei) this._seiSet.add(sei)\n    })\n  }\n\n  throw (currentTime, isLive) {\n    if (currentTime === null || currentTime === undefined || !this._seiSet.size) return\n    const min = currentTime - 0.2\n    const max = currentTime + 0.2\n    const toThrow = []\n    this._seiSet.forEach(sei => {\n      if (sei.time >= min && sei.time <= max) {\n        toThrow.push(sei)\n      }\n    })\n\n    toThrow.forEach(sei => {\n      this._seiSet.delete(sei)\n      this.emitter.emit(EVENT.SEI_IN_TIME, sei)\n    })\n\n    if (!isLive) return\n\n    this._seiSet.forEach(s => {\n      if (s.time < currentTime - 5) {\n        this._seiSet.delete(s)\n      }\n    })\n  }\n\n  reset () {\n    this._seiSet.clear()\n  }\n}\n","\n\nconst SKIP_SMALL_CHUNK = 1000\nconst MAX_CHUNK_SAVE_SIZE = 50\nconst MAX_SEGMENT_SAVE_SIZE = 3\nconst LONGTIME_NO_RECEIVE = 3000\n\nexport class BandwidthService {\n  _chunkSpeed = 0 // bps\n  _chunkCache = []\n  _speeds = [] // bps\n  _totalSize = 0\n  _totalCost = 0\n\n  /**\n   * @typedef {{\n   *  chunkCountForSpeed?: number,\n   *  skipChunkSize?: number,\n   *  longtimeNoReceived?: number\n   * }} Opts\n   *\n   * @param {Opts} opts\n   */\n  constructor (opts) {\n    this._opts = opts || {}\n  }\n\n  addRecord (totalByte, ms) {\n    if (!totalByte || !ms) return\n    this._speeds.push(8000 * totalByte / ms)\n    this._speeds = this._speeds.slice(-MAX_SEGMENT_SAVE_SIZE)\n  }\n\n  addChunkRecord (totalByte, ms) {\n    if (!totalByte || !ms || totalByte < (this._opts?.skipChunkSize || SKIP_SMALL_CHUNK)) return\n\n    this._totalSize += totalByte\n    this._totalCost += ms\n\n    this._chunkSpeed = 8000 * totalByte / ms\n    this._chunkCache.push({\n      size: totalByte,\n      duration: ms,\n      timestamp: performance.now()\n    })\n\n    const size = this._opts?.chunkCountForSpeed || MAX_CHUNK_SAVE_SIZE\n\n    if (this._chunkCache.length > size) {\n      this._chunkCache = this._chunkCache.slice(-size)\n    }\n  }\n\n  /**\n   *\n   * @returns { number }\n   */\n  getAvgSpeed () {\n    if (!this._chunkCache.length && !this._speeds.length) return 0\n    if (this._speeds.length) {\n      return this._speeds.reduce((a, c) => (a += c)) / this._speeds.length\n    }\n\n    // for long time no chunk received, append 0 size chunk\n    const lastSample = this._chunkCache[this._chunkCache.length - 1]\n    const cost = performance.now() - lastSample.timestamp\n    if ( cost > (this._opts?.longtimeNoReceived || LONGTIME_NO_RECEIVE)) {\n      this._chunkCache.push({\n        size: 0,\n        duration: cost,\n        timestamp: performance.now()\n      })\n    }\n\n    const totalSize = this._chunkCache.reduce((a, c) => a += c.size, 0)\n    const totalDuration = this._chunkCache.reduce((a, c) => a += c.duration, 0)\n    return 8000 * totalSize / totalDuration\n  }\n\n  /**\n   *\n   * @returns { number }\n   */\n  getLatestSpeed () {\n    if (!this._chunkCache.length && !this._speeds.length) return 0\n    if (this._speeds.length) {\n      return this._speeds[this._speeds.length - 1]\n    }\n    return this._chunkSpeed\n  }\n\n  /**\n   *\n   * @returns { number }\n   */\n  getTotalSize () {\n    return this._totalSize\n  }\n\n  /**\n   *\n   * @returns { number }\n   */\n  getTotalCost () {\n    return this._totalCost\n  }\n\n  reset () {\n    this._chunkCache = []\n    this._speeds = []\n    this._totalSize = 0\n    this._totalCost = 0\n  }\n}\n\n","import { EVENT } from 'xgplayer-streaming-shared'\n\nclass Stats {\n  encodeType = '' // hevc | avc\n  audioCodec = ''\n  videoCodec = ''\n  domain = '' // stream url domain\n  fps = 0\n  bitrate = 0 // 最新1s下载数据的码率\n  width = 0\n  height = 0\n  samplerate = 0\n  channelCount = 0\n  gop = 0 // 第一个gop帧数\n\n  _bitsAccumulateSize = 0\n  _bitsAccumulateDuration = 0\n  _startGopId = -1\n\n  constructor (timescale) {\n    this._timescale = timescale\n  }\n\n  getStats () {\n    return {\n      encodeType: this.encodeType,\n      audioCodec: this.audioCodec,\n      videoCodec: this.videoCodec,\n      domain: this.domain,\n      fps: this.fps,\n      bitrate: this.bitrate,\n      width: this.width,\n      height: this.height,\n      samplerate: this.samplerate,\n      channelCount: this.channelCount,\n      gop: this.gop\n    }\n  }\n\n  setEncodeType (encode) {\n    this.encodeType = encode\n  }\n\n  setFpsFromScriptData ({data}) {\n    const fps = data?.onMetaData?.framerate\n    if (fps && fps > 0 && fps < 100) {\n      this.fps = fps\n    }\n  }\n\n  setVideoMeta (track) {\n    this.width = track.width\n    this.height = track.height\n    this.videoCodec = track.codec\n    this.encodeType = track.codecType\n    if (track.fpsNum && track.fpsDen) {\n      const fps = track.fpsNum / track.fpsDen\n      if (fps > 0 && fps < 100) {\n        this.fps = fps\n      }\n    }\n  }\n\n  setAudioMeta (track) {\n    this.audioCodec = track.codec\n    this.samplerate = track.sampleRate\n    this.channelCount = track.channelCount\n  }\n\n  setDomain (responseUrl) {\n    this.domain = responseUrl.split('/').slice(2, 3)[0]\n  }\n\n  updateBitrate (samples) {\n    if (!this.fps || this.fps >= 100) {\n      if (samples.length) {\n        const duration = samples.reduce((a,b) => a += b.duration, 0) / samples.length\n        this.fps = Math.round(this._timescale / duration)\n      }\n    }\n    samples.forEach(sample => {\n      if (this._startGopId === -1) {\n        this._startGopId = sample.gopId\n      }\n      if (sample.gopId === this._startGopId) {\n        this.gop++\n      }\n      this._bitsAccumulateDuration += sample.duration / (this._timescale / 1000)\n      this._bitsAccumulateSize += sample.units.reduce((a, c) => (a += c.length), 0)\n      if (this._bitsAccumulateDuration >= 1000) {\n        this.bitrate = this._bitsAccumulateSize * 8\n        this._bitsAccumulateDuration = 0\n        this._bitsAccumulateSize = 0\n      }\n    })\n  }\n}\n\n\n/**\n * @typedef {Object} StatsInfo\n * @property {number} downloadSpeed\n * @property {number} avgSpeed\n * @property {number} currentTime\n * @property {number} bufferEnd\n * @property {number} decodeFps\n * @property {string} encodeType\n * @property {string} audioCodec\n * @property {string} videoCodec\n * @property {string} domain\n * @property {number} fps\n * @property {number} bitrate\n * @property {number} width\n * @property {number} height\n * @property {number} samplerate\n * @property {number} channelCount\n * @property {number} gop\n */\nclass MediaStatsService {\n\n  _core = null\n\n  _samples = []\n\n  constructor (core, timescale = 1000) {\n    this._core = core\n    this._timescale = timescale\n    this._stats = new Stats(timescale)\n    this._bindEvents()\n  }\n\n\n  /** @returns {StatsInfo} */\n  getStats () {\n    const { currentTime = 0, decodeFps = 0 } = this._core?.media || {}\n    return {\n      ...this._stats.getStats(),\n      downloadSpeed: this._core?.speedInfo?.().speed || 0,\n      avgSpeed: this._core?.speedInfo?.().avgSpeed || 0,\n      totalReceivedByte: this._core?.speedInfo?.().totalSize || 0,\n      totalReceivedCost: this._core?.speedInfo?.().totalCost || 0,\n      currentTime,\n      bufferEnd: this._core?.bufferInfo()?.remaining || 0,\n      decodeFps\n    }\n  }\n\n  _bindEvents () {\n    this._core.on(EVENT.DEMUXED_TRACK, ({videoTrack}) => this._stats.updateBitrate(videoTrack.samples))\n\n    this._core.on(EVENT.FLV_SCRIPT_DATA, data => {\n      this._stats.setFpsFromScriptData(data)\n    })\n\n    this._core.on(EVENT.METADATA_PARSED, e => {\n      if (e.type === 'video') {\n        this._stats.setVideoMeta(e.track)\n      } else {\n        this._stats.setAudioMeta(e.track)\n      }\n    })\n\n    this._core.on(EVENT.TTFB, e => {\n      this._stats.setDomain(e.responseUrl)\n    })\n\n  }\n\n  reset () {\n    this._samples = []\n    this._stats = new Stats(this._timescale)\n  }\n\n}\n\nexport { MediaStatsService }\n","import * as mse from './mse'\nimport * as buffer from './buffer'\nimport * as net from './net'\nimport * as error from './error'\nimport * as event from './event'\nimport * as services from './services'\nimport * as streamingHelper from './streaming-helper'\nimport { Logger } from './logger'\n\nexport default {\n  ...mse,\n  ...buffer,\n  ...net,\n  ...error,\n  ...event,\n  ...services,\n  ...streamingHelper,\n  Logger\n}\n"],"names":["Buffer","_classCallCheck","key","value","buf","length","end","start","b","buffered","error","maxHole","buffers","i","l","bufLen","last","lastEnd","push","reduce","a","c","pos","arguments","undefined","index","nextStart","nextEnd","prevStart","prevEnd","item","currentTime","behind","remaining","totalLength","media","get","isBrowser","window","ERR","MANIFEST","NETWORK","NETWORK_TIMEOUT","NETWORK_FORBIDDEN","NETWORK_NOTFOUND","NETWROK_RANGE_NOT_SATISFIABLE","DEMUX","REMUX","MEDIA","DRM","OTHER","RUNTIME","SUB_TYPES","FLV","HLS","MP4","FMP4","MSE_ADD_SB","MSE_APPEND_BUFFER","MSE_OTHER","MSE_FULL","MSE_CHANGE_TYPE","OPTION","DASH","LICENSE","CUSTOM_LICENSE","MSE_HIJACK","EME_HIJACK","SIDX","NO_CANPLAY_ERROR","BUFFERBREAK_ERROR","WAITING_TIMEOUT_ERROR","MEDIA_ERR_ABORTED","MEDIA_ERR_NETWORK","MEDIA_ERR_DECODE","MEDIA_ERR_SRC_NOT_SUPPORTED","MEDIA_ERR_CODEC_NOT_SUPPORTED","MEDIA_ERR_URL_EMPTY","ERR_CODE","_defineProperty","_ERR_CODE","StreamingError","_Error","_inherits","_super","_createSuper","type","subType","origin","payload","msg","_this","call","message","errorType","originError","ext","errorCode","errorMessage","Error","_error$response","isTimeout","url","response","httpCode","status","LogCacheLevel","DEBUG","LOG","WARN","ERROR","SIMPLE_TYPE","Logger","name","config","this","_prefix","concat","logCacheLevel","logMaxSize","logSize","logTextArray","_createClass","_console","_len","args","Array","_key","logCache","apply","disabled","console","debug","nowTime","_console2","_len2","_key2","log","_console3","_len3","_key3","warn","_console4","_len4","_key4","text","_len5","logText","_key5","finLogText","map","logable","JSON","stringify","e","delLog","shift","join","reset","_console5","group","table","groupEnd","val","Date","toLocaleString","reduceDepth","_typeof","objType","Object","prototype","toString","slice","obj","maxDepth","depth","result","includes","hasOwnProperty","createPublicPromise","res","rej","promise","Promise","resolve","reject","used","parseInt","performance","now","getTime","SafeJSON","getMediaSource","preferMMS","ManagedMediaSource","MediaSource","isMMS","mediaSource","test","OP_NAME","MSEError","MSE","_this2","create","_logger","queue","_queue","op","opName","_this2$_sourceBuffer$","_op$context","costtime","_opst","ranges","TimeRanges","getTimeRanges","_sourceBuffer","context","callback","_startQueue","event","_config","assign","getDefaultConfig","bindMedia","openLog","enable","_enqueueBlockingOp2","_unbindMedia","_bindMedia","_this$mediaSource","readyState","_this3","flag","keys","forEach","k","isArray","_url","_this$mediaSource2","duration","streaming","_mseFullFlag","VIDEO","_this4","isReduceDuration","bufferEnd","Math","max","_enqueueBlockingOp","isEnded","_this5","_openPromise","isOpened","ms","addEventListener","onOpen","costTime","_st","removeEventListener","_asyncToGenerator","_regeneratorRuntime","mark","_callee","useMMS","_this6","wrap","_context","prev","next","unbindMedia","revokeObjectURL","src","_onStartStreaming","_onEndStreaming","URL","createObjectURL","disableRemotePlayback","abrupt","stop","_x","_callee2","hasMetadata","mseOpen","_this7","_context2","t","x","_x$promise","_x$promise$resolve","endOfStream","removeSourceBuffer","removeAttribute","load","mimeType","sb","addSourceBuffer","_onSBUpdateEnd","bind","_onSBUpdateError","_this8","changeType","_enqueueOp","createSource","buffer","_this9","byteLength","_this9$_sourceBuffer$","appendBuffer","startTime","endTime","_this10","isInsertHead","remove","p","_this11","_this12","allClear","_this$_queue$type","initQueue","isinit","reason","_this13","setLiveSeekableRange","exec","_this14","splice","then","_callee3","types","waiters","_this15","_context3","prom","all","updating","_x2","_x3","_x4","_op$promise","_op$promise2","indexOf","isFull","constructor","timestampOffset","_this16","_this17","abort","mime","isTypeSupported","UPDATE_ERROR","LoaderType","FETCH","XHR","ResponseType","ARRAY_BUFFER","TEXT","NetError","request","_assertThisInitialized","isPlainObject","getPrototypeOf","getRangeValue","ret","encode","encodeURIComponent","replace","setUrlParams","params","v","str","toISOString","isObject","filter","Boolean","hashIndex","createResponse","data","done","contentLength","age","firstByteTime","range","vid","priOptions","parseFloat","Number","isNaN","options","calculateSpeed","byteLen","milliSecond","round","EVENT","TTFB","LOAD_START","LOAD_RESPONSE_HEADERS","LOAD_COMPLETE","LOAD_RETRY","SOURCEBUFFER_CREATED","MEDIASOURCE_OPENED","ANALYZE_DURATION_EXCEEDED","APPEND_BUFFER","REMOVE_BUFFER","BUFFEREOS","KEYFRAME","CHASEFRAME","METADATA_PARSED","SEI","SEI_IN_TIME","FLV_SCRIPT_DATA","LOWDECODE","SWITCH_URL_SUCCESS","SWITCH_URL_FAILED","SPEED","HLS_MANIFEST_LOADED","HLS_LEVEL_LOADED","DEMUXED_TRACK","STREAM_EXCEPTION","LARGE_AV_FIRST_FRAME_GAP_DETECT","LARGE_VIDEO_DTS_GAP_DETECT","LARGE_AUDIO_DTS_GAP_DETECT","AUDIO_GAP_DETECT","AUDIO_OVERLAP_DETECT","MAX_DTS_DELTA_WITH_NEXT_SEGMENT_DETECT","REAL_TIME_SPEED","has","prefix","Events","EE","fn","once","addListener","emitter","TypeError","listener","evt","_events","_eventsCount","clearEvent","EventEmitter","__proto__","eventNames","names","events","getOwnPropertySymbols","listeners","handlers","ee","listenerCount","emit","a1","a2","a3","a4","a5","len","removeListener","j","on","removeAllListeners","off","prefixed","module","exports","CACHESIZE","FetchLoader","_EventEmitter","_cancel","_ref","_this$_abortControlle","timeout","responseType","onProgress","onTimeout","onCancel","transformResponse","logger","method","headers","body","mode","credentials","cache","redirect","referrer","referrerPolicy","onProcessMinLen","_aborted","_onProcessMinLen","_onCancel","_abortController","AbortController","_running","_index","_range","_vid","_priOptions","init","signal","clearTimeout","_timeoutTimer","rangeValue","Headers","append","Range","setTimeout","cancel","fetch","_ref2","speed","_response","ok","sent","json","_loadChunk","arrayBuffer","Uint8Array","time","catch","_error","_reader","t0","st","getReader","err","_cache","_writeIdx","reader","pump","_ref3","_this3$_range","startRange","startByte","curLen","retData","temp","read","_receivedLength","set","XhrLoader","req","_onProgress","_headers","_withCredentials","_body","_method","_timeout","_runing","_responseType","_firstRtt","_onTimeout","_request","_loadCompleteResolve","_loadCompleteReject","_startLoad","chunkSize","_currentChunkSizeKB","from","to","_internalOpen","_startTime","xhr","_xhr","XMLHttpRequest","open","withCredentials","onload","_onLoad","onreadystatechange","_onReadyStatechange","onerror","errorEvent","_errorEvent$currentTa","_errorEvent$currentTa2","_errorEvent$currentTa3","currentTarget","statusText","ontimeout","setRequestHeader","send","target","_this$_range","_objectSpread","byteStart","_this$_range2","chunk","responseURL","_getHeaders","_transformResponse","_getPrototypeOf","_step","_iterator","_createForOfIteratorHelper","getAllResponseHeaders","trim","split","s","n","parts","toLowerCase","f","Task","alive","_loaderType","_loader","_retryCount","_retryTimer","_canceled","_retryCheckFunc","retryCheckFunc","_this$_config","retry","retryDelay","onRetryError","transformError","rest","_objectWithoutProperties","_excluded","isRetry","running","loaderType","retryCount","sleep","paused","ended","playbackRate","video","getVideoPlaybackQuality","info","droppedVideoFrames","corruptedVideoFrames","totalVideoFrames","creationTime","webkitDroppedFrameCount","webkitDecodedFrameCount","arr","prevLen","d","NetLoader","cfg","transformRequest","integrity","getConfig","isSupported","task","loader","_currentTask","_processTask","cancels","_alive","finally","_this3$_currentTask","_this3$_alive","GapService","maxJumpDistance","isLive","seekThreshold","jumpTo","_prevCurrentTime","seeking","SeiService","Set","sei","_seiSet","add","size","min","toThrow","delete","clear","BandwidthService","opts","_opts","totalByte","_speeds","_this$_opts","_this$_opts2","skipChunkSize","_totalSize","_totalCost","_chunkSpeed","_chunkCache","timestamp","chunkCountForSpeed","_this$_opts3","lastSample","cost","longtimeNoReceived","Stats","timescale","_timescale","encodeType","audioCodec","videoCodec","domain","fps","bitrate","width","height","samplerate","channelCount","gop","_data$onMetaData","onMetaData","framerate","track","codec","codecType","fpsNum","fpsDen","sampleRate","responseUrl","samples","sample","_startGopId","gopId","_bitsAccumulateDuration","_bitsAccumulateSize","units","MediaStatsService","core","_core","_stats","_bindEvents","_this$_core","_this$_core2","_this$_core2$speedInf","_this$_core3","_this$_core3$speedInf","_this$_core4","_this$_core4$speedInf","_this$_core5","_this$_core5$speedInf","_this$_core6","_this$_core6$bufferIn","_ref2$currentTime","_ref2$decodeFps","decodeFps","getStats","downloadSpeed","speedInfo","avgSpeed","totalReceivedByte","totalSize","totalReceivedCost","totalCost","bufferInfo","videoTrack","updateBitrate","setFpsFromScriptData","setVideoMeta","setAudioMeta","setDomain","_samples","mse","net","services","streamingHelper"],"mappings":"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"}